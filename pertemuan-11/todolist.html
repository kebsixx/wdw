<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>To-Do List - jQuery + Bootstrap</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet" />
    <!-- Bootstrap Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet" />
    <style>
      /* Minimal CSS for gradient background */
      body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }
    </style>
  </head>
  <body>
    <div class="container py-5">
      <div
        class="card shadow-lg rounded-4 mx-auto border-0"
        style="
          max-width: 650px;
          background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        ">
        <div
          class="card-header bg-gradient text-primary text-center py-4 border-0">
          <h1 class="display-5 fw-bold mb-4 text-gradient">To-Do List</h1>
          <div class="input-group input-group-lg">
            <input
              type="text"
              id="new-task"
              class="form-control form-control-lg border-primary"
              placeholder="Tambah tugas baru..."
              aria-label="Tambah tugas baru" />
            <button class="btn btn-primary btn-lg" id="add-btn" type="button">
              <i class="bi bi-plus-circle-fill me-1"></i> Tambah
            </button>
          </div>
        </div>
        <div class="card-body p-4">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <div class="btn-group btn-group-lg" role="group">
              <button
                type="button"
                class="btn btn-outline-primary filter-btn active fw-semibold">
                <i class="bi bi-list-ul me-1"></i>Semua
              </button>
              <button
                type="button"
                class="btn btn-outline-success filter-btn fw-semibold"
                data-filter="active">
                <i class="bi bi-play-circle me-1"></i>Aktif
              </button>
              <button
                type="button"
                class="btn btn-outline-secondary filter-btn fw-semibold"
                data-filter="completed">
                <i class="bi bi-check-circle me-1"></i>Selesai
              </button>
            </div>
            <div class="d-flex align-items-center">
              <button
                class="btn btn-outline-danger btn-sm me-3 fw-semibold"
                id="clear-completed">
                <i class="bi bi-trash3 me-1"></i>Hapus Selesai
              </button>
              <span class="badge bg-primary fs-6 px-3 py-2 rounded-pill">
                Aktif: <span id="active-count" class="fw-bold">0</span>
              </span>
            </div>
          </div>
          <ul id="todo-list" class="list-unstyled mb-4">
            <!-- Tasks will be added here -->
          </ul>
          <div id="empty-state" class="text-center text-muted p-5 d-none">
            <i
              class="bi bi-check-circle-fill display-1 text-success opacity-25 mb-3"></i>
            <h4 class="text-muted">Tidak ada tugas</h4>
            <p class="lead">Tambah tugas baru di atas untuk memulai!</p>
          </div>
        </div>
      </div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      $(document).ready(function () {
        let todos = JSON.parse(localStorage.getItem("todos")) || [];

        renderTodos();

        $("#add-btn").click(addTask);
        $("#new-task").keypress(function (e) {
          if (e.which === 13) {
            addTask();
          }
        });

        $(".filter-btn").click(function () {
          $(".filter-btn").removeClass("active");
          $(this).addClass("active");
          filterTodos($(this).data("filter"));
        });

        $("#clear-completed").click(function () {
          todos = todos.filter((todo) => !todo.completed);
          saveTodos();
          renderTodos();
        });

        $("#todo-list").on("click", ".btn-complete", function () {
          const id = $(this).closest(".todo-item").data("id");
          toggleComplete(id);
        });

        $("#todo-list").on("click", ".btn-delete", function () {
          const $item = $(this).closest(".todo-item");
          const id = $item.data("id");
          $item.fadeOut(300, function () {
            todos = todos.filter((todo) => todo.id !== id);
            saveTodos();
            renderTodos();
          });
        });

        function addTask() {
          const text = $("#new-task").val().trim();
          if (text === "") return;

          const newTodo = {
            id: Date.now(),
            text: text,
            completed: false,
          };

          todos.push(newTodo);
          saveTodos();
          renderTodos();
          $("#new-task").val("");
        }

        function toggleComplete(id) {
          todos = todos.map((todo) => {
            if (todo.id === id) {
              return { ...todo, completed: !todo.completed };
            }
            return todo;
          });
          saveTodos();
          renderTodos();
        }

        function renderTodos() {
          $("#todo-list").empty();
          const filteredTodos = getFilteredTodos();

          if (filteredTodos.length === 0) {
            $("#empty-state").removeClass("d-none");
          } else {
            $("#empty-state").addClass("d-none");
            filteredTodos.forEach((todo) => {
              const completedClass = todo.completed
                ? "text-decoration-line-through text-muted opacity-50"
                : "";
              const iconClass = todo.completed
                ? "bi-check-circle-fill text-success"
                : "bi-circle text-primary";
              const itemClass = todo.completed
                ? "bg-light-subtle border-success"
                : "bg-white border-primary-subtle";
              const $item = $(`
              <li class="todo-item d-flex align-items-center py-3 px-3 mb-2 rounded-3 border ${itemClass} shadow-sm" data-id="${
                todo.id
              }">
                <button class="btn btn-outline-success border-0 bg-transparent me-3 fs-5 btn-complete">
                  <i class="bi ${iconClass}"></i>
                </button>
                <span class="flex-grow-1 me-3 fs-6 fw-medium text-truncate ${completedClass}">${escapeHtml(
                todo.text
              )}</span>
                <button class="btn btn-outline-danger border-0 bg-transparent fs-5 btn-delete">
                  <i class="bi bi-trash3-fill"></i>
                </button>
              </li>
            `);
              $("#todo-list").append($item);
            });
          }

          updateActiveCount();
        }

        function filterTodos(filter) {
          renderTodos();
        }

        function getFilteredTodos() {
          const activeFilter = $(".filter-btn.active").data("filter");
          if (activeFilter === "all") {
            return todos;
          } else if (activeFilter === "active") {
            return todos.filter((todo) => !todo.completed);
          } else if (activeFilter === "completed") {
            return todos.filter((todo) => todo.completed);
          }
          return todos;
        }

        function updateActiveCount() {
          const activeCount = todos.filter((todo) => !todo.completed).length;
          $("#active-count").text(activeCount);
        }

        function saveTodos() {
          localStorage.setItem("todos", JSON.stringify(todos));
        }

        function escapeHtml(text) {
          const map = {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            '"': "&quot;",
            "'": "&#039;",
          };
          return text.replace(/[&<>"']/g, function (m) {
            return map[m];
          });
        }
      });
    </script>
  </body>
</html>
